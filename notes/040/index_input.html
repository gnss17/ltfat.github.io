<!DOCTYPE html>
<html lang="en">
<head class="include" file="../../include/header.html">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta NAME="keywords" CONTENT="gabor, signal processing, matlab,
octave"/>
<title>A Non-iterative Method for STFT Phase (Re)Construction</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="../../include/style.css" type="text/css">
<link rel="stylesheet" href="../../include/highlight.css" type="text/css">
<link rel="stylesheet" href="ltfatnote040.css">
</head>

<!-- body must stay hidden until all include parts are loaded -->
<body style="display:none;">
<!-- Wrap the content into responsive container --!>
<div class="container">
<!-- Include main navigation -->
<div class="masthead include" file="../../include/mainnav.html">
</div>
<div class="row">

<div class="page-header">
    <h1>A Non-iterative Method for STFT Phase (Re)Construction</h1>
    Zdeněk Průša, Peter Balazs, Peter L. Søndergaard
</div>
<div class="well">
<strong>Abstract:</strong>
<p>
A non-iterative method for the construction of the Short-Time Fourier 
Transform (STFT) phase from the magnitude is presented.
The method is based on the direct relationship
between the partial derivatives of the phase and the logarithm of the magnitude
of STFT with respect to the Gaussian window.
Although the theory holds in the continuous setting only,
the experiments show that the algorithm performs well
even in the discretized setting (Discrete Gabor transform) with low redundancy
using the sampled Gaussian window, the truncated Gaussian window and even other
compactly supported windows like the Hann window.

Due to the non-iterative nature,
the algorithm is very fast and it is suitable for long audio signals.
Moreover, the solutions of iterative phase reconstruction algorithms
can be improved considerably by initializing them
with the phase estimate provided by the present algorithm.

We present an extensive and reproducible comparison with the
state-of-the-art algorithms.
</p>
</div>

<div class="alert alert-warning" role="alert">
<strong>Reproducible research:</strong>
    <p>
    The following archive <a href="ltfatnote040.zip">ltfatnote040.zip</a>
    contains scripts reproducing figures and tables from the paper.
    </p>
    <p>
    Please note that LTFAT toolbox (version>=2.1.2, available
    <a href="http://ltfat.github.io">here</a>) and
    PHASERET (version>=0.1.0, available 
    <a href="http://ltfat.github.io/phaseret">here</a>)
    must be installed in order to run the scripts.
    </p>

    <div class="row text-center" style="margin-top: 1em">
    <div class="col-md-6">
    <figure>
        <img width="440" src="greasy_1_color.png"></img>
    <figcaption>(a) Spectrogram</figcaption>
    </figure>
    <figure>
        <img width="440" src="phasediff_2_color.png"></img>
        <figcaption>(c) <i>a=16</i></figcaption>
    </figure>

    </div>
    <div class="col-md-6">
    <figure>
        <img width="440" src="phasediff_1_color.png"></img>
        <figcaption><i>(b)a=1</i></figcaption>
    </figure>
        <figure>
        <img width="440" src="phasediff_3_color.png"></img>
        <figcaption><i>(d)a=32</i></figcaption>
    </figure>
    </div>
    Fig. 1: Spectrogram of a spoken word <i>greasy</i> (a). The absolute phase differences of
    the STFT of the original and reconstructed signal in rad/pi for varying time hop size
    <i>a</i> (b) (c) (d).
    </div>

    <div class="row text-center" style="margin-top: 1em">
    <div class="col-md-6">
    <figure>
        <img width="440" src="gspi_8192_color.png"></img>
    <figcaption>(a) Spectrogram</figcaption>
    </figure>
    <figure>
        <img width="440" src="gspi_phasediffunwrap_color.png"></img>
        <figcaption>(c) Alg. [18]</figcaption>
    </figure>

    </div>
    <div class="col-md-6">
    <figure>
        <img width="440" src="gspi_phasediffspsi_color.png"></img>
        <figcaption>(b) Alg. [16]</figcaption>
    </figure>
        <figure>
        <img width="440" src="gspi_phasediffheapint_color.png"></img>
        <figcaption>Proposed</figcaption>
    </figure>
    </div>
    Fig. 2: Spectrogram of an excerpt from the <i>glockenspiel</i> signal and the
absolute phase differences in rad/pi for three different algorithms.
</div>

<div class="row text-center" style="margin-top: 1em">
    <figure>
        <img width="800" src="gausscomparison_mocha.png"></img>
        <figcaption>(a) Gaussian window</figcaption>
    </figure>
    <figure>
        <img width="800" src="hanncomparison_mocha.png"></img>
        <figcaption>(b) Hann window</figcaption>
    </figure>
    <figure>
        <img width="800" src="hammingcomparison_mocha.png"></img>
        <figcaption>(c) Hamming window</figcaption>
    </figure>
    Fig. 3: Comparison with the iterative algorithms, speech database.
</div>

<div class="row text-center" style="margin-top: 1em">
    <figure>
        <img width="800" src="gausscomparison_sqam.png"></img>
        <figcaption>(a) Gaussian window</figcaption>
    </figure>
    <figure>
        <img width="800" src="hanncomparison_sqam.png"></img>
        <figcaption>(b) Hann window</figcaption>
    </figure>
    <figure>
        <img width="800" src="hammingcomparison_sqam.png"></img>
        <figcaption>(c) Hamming window</figcaption>
    </figure>
    Fig. 4: Comparison with the iterative algorithms, SQAM database.
</div>
</div>

<div>
    <div class="stickycont well" id="table2back">
<strong>Additional content:</strong>
        <p>
        The following tables show errors in dB for all 70 samples from the 
        <a href="https://tech.ebu.ch/publications/sqamcd">EBU SQAM database</a>
        for the proposed algorithm and for SPSI, GLA, FleGLA, RTISI-LA and GLA, FleGLA
        with warm starting. The results are shown only for the Gaussian window.
        The number of iterations of the iterative algorithms was fixed to 200.
         <ul>
            <li><a href="#table2">Table 1</a> is an addendum to Table II and Fig. 4. It
            shows performance of the algorithms on unmodified spectrograms. </li>
            <li><a href="#table3">Table 2</a> shows the same as Table 1 for
            time-stretched spectrograms. The files were resampled to the original duration
            to achieve pitch shift by 6 semitones up.</li>
            <li><a href="#table4">Table 3</a> shows the same as Table 1 for
            time-compressed spectrograms. The files were resampled to the original
            duration to achieve pitch shift by 6 semitones down.</li>
        </ul>
        Note the values in tables 2 and 3 should serve just as a rough quality indicators.
        </p>
        <p>
        The playback can be started by selecting one of the table cells (the enabled ones
        turn yellow when the cursor hovers over them).
        All the files were compressed by oggenc from vorbis-tools 1.4.0 with
        the default settings.
        Your browser must support HTML5 audio player
        and it must be able to decode ogg files. Alternativelly, the file
        path is shown below the player and it can be downloaded by Save Link As ...
        </p>
        <div class="playerdiv" id="table2">
            <table border="0" cellspacing="5" cellpadding="0">
                <tr><th colspan="9">Table 1: 
                        Addendum to Table II and Fig. 4. <br/>
                        <audio id="audplayer2" controls style="width:90%" preload="none">
                            <!-- <source src="sqam/01.ogg" type="audio/ogg"> -->
                            Warning! Your browser does not support HTML5 audio player.
                            You will have to download and play the files yourself.
                        </audio><br/>
                        Loaded file: <span id="loadedfile2">None</span>
                </th></tr>
            </table>
        </div>

        <table class="comptable small text-center errtable" cellspacing="0" cellpadding="0"
            id="errtable2">
            {ERRTABLE}
         </table>

        <div class="playerdiv" id="table3">
            <table border="0" cellspacing="5" cellpadding="0">
                <tr><th colspan="9">
                        Addendum to Sec V. C. Pitch shift by +6 semitones. <br/>
                        <audio id="audplayer3" controls style="width:90%" preload="none">
                            <!-- <source src="sqam/01.ogg" type="audio/ogg"> -->
                            Warning! Your browser does not support HTML5 audio player.
                            You will have to download and play the files yourself.
                        </audio><br/>
                        Loaded file: <span id="loadedfile3">None</span>
                </th></tr>
            </table>
        </div>

        <table class="comptable small text-center errtable" cellspacing="0"
            cellpadding="0" id="errtable3">
            {ERRTABLESHIFTUP}
         </table>

         <div class="playerdiv" id="table4">
            <table border="0" cellspacing="5" cellpadding="0">
                <tr><th colspan="9">
                        Addendum to Sec V. C. Pitch shift by -6 semitones.<br/>
                        <audio id="audplayer4" controls style="width:90%" preload="none">
                            <!-- <source src="sqam/01.ogg" type="audio/ogg"> -->
                            Warning! Your browser does not support HTML5 audio player.
                            You will have to download and play the files yourself.
                        </audio><br/>
                        Loaded file: <span id="loadedfile4">None</span>
                </th></tr>
            </table>
        </div>

        <table class="comptable small text-center errtable" cellspacing="0"
            cellpadding="0" id="errtable4">
            {ERRTABLESHIFTDOWN}
         </table>
    </div>

</div>


        <div class="include" file="../../include/footer.html"></div>
    </div>
</div>
<!-- These two have to be here to dynamically load the included parts -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="../../js/ltfat.js" type="text/javascript"></script>
<script src="../include/lookup.js" type="text/javascript"></script>
<script src="../include/jumplist.js" type="text/javascript"></script>
<script src="jquery.sticky-kit.min.js"></script>
<script src="ltfatnote040.js"></script>
</body>
</html>


